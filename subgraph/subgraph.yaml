specVersion: 0.0.4
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum/contract
    name: NFTYFinance
    network: mainnet
    source:
      abi: NFTYFinance
      address: "0xa513E6E4b8f2a923D98304ec87F64353C4D5C853"
      startBlock: 8
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - LendingDesk
        - ProtocolParams
        - Erc20
        - NftCollection
        - Loan
      abis:
        - name: NFTYFinance
          file: ../contracts/artifacts/contracts/NFTYFinanceV1.sol/NFTYFinanceV1.json
        - name: ERC20
          file: ../contracts/artifacts/@openzeppelin/contracts/token/ERC20/ERC20.sol/ERC20.json
      eventHandlers:
        - event: OwnershipTransferred(indexed address,indexed address)
          handler: handleOwnershipTransferred
        - event: LoanOriginationFeeSet(uint256)
          handler: handleLoanOriginationFeeSet
        - event: ProtocolInitialized(address,address,address)
          handler: handleProtocolInitialized
        - event: NewLendingDeskInitialized(uint256,address,address)
          handler: handleNewLendingDeskInitialized
        - event: LendingDeskLiquidityDeposited(uint256,uint256)
          handler: handleLendingDeskLiquidityDeposited
        - event: LendingDeskLiquidityWithdrawn(uint256,uint256)
          handler: handleLendingDeskLiquidityWithdrawn
        - event: LendingDeskLoanConfigsSet(uint256,(address,bool,uint256,uint256,uint256,uint256,uint256,uint256)[])
          handler: handleLendingDeskLoanConfigsSet
        - event: LendingDeskLoanConfigRemoved(uint256,address)
          handler: handleLendingDeskLoanConfigRemoved
        - event: LendingDeskStateSet(uint256,bool)
          handler: handleLendingDeskStateSet
        - event: LendingDeskDissolved(uint256)
          handler: handleLendingDeskDissolved
        - event: Paused(address)
          handler: handlePaused
        - event: Unpaused(address)
          handler: handleUnpaused
        - event: NewLoanInitialized(uint256,uint256,address,address,uint256,uint256,uint256,uint256,uint256)
          handler: handleNewLoanInitialized
        - event: LoanPaymentMade(uint256,uint256,bool)
          handler: handleLoanPaymentMade
        - event: DefaultedLoanLiquidated(uint256)
          handler: handleDefaultedLoanLiquidated
        - event: PlatformFeesWithdrawn(address,address[])
          handler: handlePlatformFeesWithdrawn
      file: ./src/nfty-finance.ts
  - kind: ethereum/contract
    name: LendingKeys
    network: mainnet
    source:
      abi: LendingKeys
      address: "0x0165878A594ca255338adfa4d48449f69242Eb8F"
      startBlock: 7
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - LendingDesk
      abis:
        - name: LendingKeys
          file: ../contracts/artifacts/contracts/NFTYERC721V1.sol/NFTYERC721V1.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,indexed uint256)
          handler: handleTransfer
      file: ./src/lending-keys.ts
  - kind: ethereum/contract
    name: PromissoryNotes
    network: mainnet
    source:
      abi: PromissoryNotes
      address: "0xDc64a140Aa3E981100a9becA4E685f962f0cF6C9"
      startBlock: 5
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - Loan
      abis:
        - name: PromissoryNotes
          file: ../contracts/artifacts/contracts/NFTYERC721V1.sol/NFTYERC721V1.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,indexed uint256)
          handler: handleTransfer
      file: ./src/promissory-notes.ts
  - kind: ethereum/contract
    name: ObligationNotes
    network: mainnet
    source:
      abi: ObligationNotes
      address: "0x5FC8d32690cc91D4c39d9d3abcBD16989F875707"
      startBlock: 6
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - Loan
      abis:
        - name: ObligationNotes
          file: ../contracts/artifacts/contracts/NFTYERC721V1.sol/NFTYERC721V1.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,indexed uint256)
          handler: handleTransfer
      file: ./src/obligation-notes.ts
