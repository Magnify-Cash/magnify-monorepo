specVersion: 0.0.4
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum/contract
    name: NFTYFinance
    network: mainnet
    source:
      abi: NFTYFinance
      address: "0x9C85258d9A00C01d00ded98065ea3840dF06f09c"
      startBlock: 383
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - LendingDesk
        - ProtocolParams
        - Erc20
        - NftCollection
        - Loan
      abis:
        - name: NFTYFinance
          file: ../contracts/artifacts/contracts/NFTYFinanceV1.sol/NFTYFinanceV1.json
        - name: ERC20
          file: ../contracts/artifacts/@openzeppelin/contracts/token/ERC20/ERC20.sol/ERC20.json
      eventHandlers:
        - event: OwnershipTransferred(indexed address,indexed address)
          handler: handleOwnershipTransferred
        - event: LoanOriginationFeeSet(uint256)
          handler: handleLoanOriginationFeeSet
        - event: ProtocolInitialized(address,address,address)
          handler: handleProtocolInitialized
        - event: NewLendingDeskInitialized(uint256,address,address)
          handler: handleNewLendingDeskInitialized
        - event: LendingDeskLiquidityDeposited(uint256,uint256)
          handler: handleLendingDeskLiquidityDeposited
        - event: LendingDeskLiquidityWithdrawn(uint256,uint256)
          handler: handleLendingDeskLiquidityWithdrawn
        - event: LendingDeskLoanConfigsSet(uint256,(address,bool,uint256,uint256,uint256,uint256,uint256,uint256)[])
          handler: handleLendingDeskLoanConfigsSet
        - event: LendingDeskLoanConfigRemoved(uint256,address)
          handler: handleLendingDeskLoanConfigRemoved
        - event: LendingDeskStateSet(uint256,bool)
          handler: handleLendingDeskStateSet
        - event: LendingDeskDissolved(uint256)
          handler: handleLendingDeskDissolved
        - event: Paused(address)
          handler: handlePaused
        - event: Unpaused(address)
          handler: handleUnpaused
        - event: NewLoanInitialized(uint256,uint256,address,address,uint256,uint256,uint256,uint256,uint256)
          handler: handleNewLoanInitialized
        - event: LoanPaymentMade(uint256,uint256,bool)
          handler: handleLoanPaymentMade
        - event: DefaultedLoanLiquidated(uint256)
          handler: handleDefaultedLoanLiquidated
        - event: PlatformFeesWithdrawn(address,address[])
          handler: handlePlatformFeesWithdrawn
      file: ./src/nfty-finance.ts
  - kind: ethereum/contract
    name: LendingKeys
    network: mainnet
    source:
      abi: LendingKeys
      address: "0x1D3EDBa836caB11C26A186873abf0fFeB8bbaE63"
      startBlock: 382
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - LendingDesk
      abis:
        - name: LendingKeys
          file: ../contracts/artifacts/contracts/NFTYERC721V1.sol/NFTYERC721V1.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,indexed uint256)
          handler: handleTransfer
      file: ./src/lending-keys.ts
  - kind: ethereum/contract
    name: PromissoryNotes
    network: mainnet
    source:
      abi: PromissoryNotes
      address: "0x4ff1f64683785E0460c24A4EF78D582C2488704f"
      startBlock: 380
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - Loan
      abis:
        - name: PromissoryNotes
          file: ../contracts/artifacts/contracts/NFTYERC721V1.sol/NFTYERC721V1.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,indexed uint256)
          handler: handleTransfer
      file: ./src/promissory-notes.ts
  - kind: ethereum/contract
    name: ObligationNotes
    network: mainnet
    source:
      abi: ObligationNotes
      address: "0x0F527785e39B22911946feDf580d87a4E00465f0"
      startBlock: 381
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - Loan
      abis:
        - name: ObligationNotes
          file: ../contracts/artifacts/contracts/NFTYERC721V1.sol/NFTYERC721V1.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,indexed uint256)
          handler: handleTransfer
      file: ./src/obligation-notes.ts
