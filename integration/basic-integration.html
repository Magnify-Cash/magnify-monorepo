<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Basic Integration (Ethers) - Magnify Cash</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../book.css">
        <link rel="stylesheet" href="../theme/css/general.css">
        <link rel="stylesheet" href="../theme/css/variables.css">


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Magnify Cash</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/Magnify-Cash/magnify-monorepo" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2 id="introduction"><a class="header" href="#introduction">Introduction</a></h2>
<p>The MagnifyCashV1 contract is a decentralized lending platform that allows users to lend and borrow against their NFT assets. This integration guide will walk you through the process of interacting with the MagnifyCashV1 contract using the Ethers.js library. You'll learn how to initialize new lending desks, set loan configurations, deposit and withdraw liquidity, and initiate new loans.</p>
<h2 id="integration-steps"><a class="header" href="#integration-steps">Integration Steps</a></h2>
<p>This guide covers the following key functionalities:</p>
<ul>
<li>Initializing a new lending desk</li>
<li>Setting new loan configs for a lending desk</li>
<li>Depositing liquidity into a lending desk</li>
<li>Withdrawing liquidity from a lending desk</li>
<li>Initializing a new loan</li>
</ul>
<p>You'll need to replace the following placeholders with your actual values:</p>
<ul>
<li><code>your-ethereum-node-url</code>: The URL of your Ethereum node (e.g., Infura, Alchemy, or your own node)</li>
<li><code>your-private-key</code>: The private key of the Ethereum account you'll be using to interact with the contract</li>
<li><code>contract-address</code>: The address of the deployed MagnifyCashV1 contract</li>
<li><code>0x...</code>: The addresses of the ERC20 token, NFT collection, and other contract-specific addresses</li>
</ul>
<h2 id="code"><a class="header" href="#code">Code</a></h2>
<pre><code class="language-javascript">// Import the necessary Ethers.js modules
const { ethers } = require('ethers');

// Set up the provider and signer
const provider = new ethers.providers.JsonRpcProvider('https://your-ethereum-node-url');
const signer = new ethers.Wallet('your-private-key', provider);

// Load the contract ABI
const contractABI = [
  // Contract ABI goes here
];

// Create the contract instance
const contract = new ethers.Contract('contract-address', contractABI, signer);

// Example usage: Initialize a new lending desk
const erc20 = '0x...'; // Address of the ERC20 token to be used
const depositAmount = ethers.utils.parseEther('1000'); // Initial balance of the lending desk
const loanConfigs = [
  {
    nftCollection: '0x...', // Address of the NFT collection
    minAmount: ethers.utils.parseEther('0.1'), // Minimum loan amount
    maxAmount: ethers.utils.parseEther('1'), // Maximum loan amount
    minInterest: 500, // Minimum interest rate (in basis points)
    maxInterest: 2000, // Maximum interest rate (in basis points)
    minDuration: 24, // Minimum loan duration (in hours)
    maxDuration: 720 // Maximum loan duration (in hours)
  }
];

async function initializeNewLendingDesk() {
  try {
    const tx = await contract.initializeNewLendingDesk(erc20, depositAmount, loanConfigs);
    await tx.wait(); // Wait for the transaction to be mined
    console.log('New lending desk initialized');
  } catch (error) {
    console.error('Error initializing new lending desk:', error);
  }
}

// Example usage: Set new loan configs for a lending desk
const lendingDeskId = 1;
const newLoanConfigs = [
  // New loan config details
];

async function setLendingDeskLoanConfigs() {
  try {
    const tx = await contract.setLendingDeskLoanConfigs(lendingDeskId, newLoanConfigs);
    await tx.wait(); // Wait for the transaction to be mined
    console.log('Lending desk loan configs updated');
  } catch (error) {
    console.error('Error updating lending desk loan configs:', error);
  }
}

// Example usage: Deposit liquidity into a lending desk
const lendingDeskId = 1;
const depositAmount = ethers.utils.parseEther('100');

async function depositLendingDeskLiquidity() {
  try {
    const tx = await contract.depositLendingDeskLiquidity(lendingDeskId, depositAmount);
    await tx.wait(); // Wait for the transaction to be mined
    console.log('Liquidity deposited into lending desk');
  } catch (error) {
    console.error('Error depositing liquidity into lending desk:', error);
  }
}

// Example usage: Withdraw liquidity from a lending desk
const lendingDeskId = 1;
const withdrawalAmount = ethers.utils.parseEther('50');

async function withdrawLendingDeskLiquidity() {
  try {
    const tx = await contract.withdrawLendingDeskLiquidity(lendingDeskId, withdrawalAmount);
    await tx.wait(); // Wait for the transaction to be mined
    console.log('Liquidity withdrawn from lending desk');
  } catch (error) {
    console.error('Error withdrawing liquidity from lending desk:', error);
  }
}

// Example usage: Initialize a new loan
const lendingDeskId = 1;
const nftCollection = '0x...'; // Address of the NFT collection
const nftId = 123; // ID of the NFT to be used as collateral
const loanAmount = ethers.utils.parseEther('0.5');
const loanDuration = 72; // Duration in hours
const maxInterestAllowed = 1500; // Maximum interest rate (in basis points)

async function initializeNewLoan() {
  try {
    const tx = await contract.initializeNewLoan(
      lendingDeskId,
      nftCollection,
      nftId,
      loanDuration,
      loanAmount,
      maxInterestAllowed
    );
    await tx.wait(); // Wait for the transaction to be mined
    console.log('New loan initialized');
  } catch (error) {
    console.error('Error initializing new loan:', error);
  }
}
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../integration/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../integration/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../solidity.min.js"></script>


    </div>
    </body>
</html>
