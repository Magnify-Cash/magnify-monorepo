<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Magnify Cash</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="book.css">
        <link rel="stylesheet" href="theme/css/general.css">
        <link rel="stylesheet" href="theme/css/variables.css">


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Magnify Cash</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/Magnify-Cash/magnify-monorepo" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="magnifycash"><a class="header" href="#magnifycash">MagnifyCash</a></h1>
<p>MagnifyCash is an onchain protocol that facilitates lending and borrowing of ERC20 tokens using NFTs as collateral. The protocol introduces a novel AMM-style architecture called "LAMM" (Lending Automated Market Maker) for lending markets.</p>
<p>The protocol provides a simple but powerful DeFi primitive where any NFT can be lent against any fungible token. All lending parameters are fully customizable - duration, interest, and loan value - offering liquidity providers a full range of capital utilization.</p>
<p>In contrast to many lending markets, the MagnifyCash protocol supports lending for any type of fungible or non-fungible asset. This approach targets the long-tail of asset distribution, where there are tens and thousands of assets without any suitable markets.</p>
<p>Additionally, the MagnifyCash protocol is entirely dependency-free. All transactions are between a lender and borrower exclusively, free of any external third parties. By doing so, users are able to manage risk on their own accord, without worrying about mass liqudiation events, flash crashes, and the like.</p>
<p>Going a step further, lender and borrower positions in the protocol are tokenized. The goal here is a composable base layer where developers can steadily build on top of for years to come.</p>
<h2 id="table-of-contents"><a class="header" href="#table-of-contents">Table of Contents</a></h2>
<ul>
<li><a href="contracts/contracts/interfaces">Interfaces</a></li>
<li><a href="contracts/contracts">Contracts</a></li>
<li><a href="integration/">Integration Guides</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="interfaces"><a class="header" href="#interfaces">Interfaces</a></h1>
<p>The MagnifyCash protocol utilizes two main interface files.</p>
<ul>
<li><a href="contracts/contracts/interfaces/IMagnifyCashV1.sol/contract.IMagnifyCashV1.html">IMagnifyCashV1</a>: Interface for core protocol module.</li>
<li><a href="contracts/contracts/interfaces/IMagnifyERC721V1.sol/contract.IMagnifyERC721V1.html">IMagnifyERC721V1</a>: Interface for ERC721 tokenization, used in both the lending keys and the obligation notes</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="imagnifycashv1"><a class="header" href="#imagnifycashv1">IMagnifyCashV1</a></h1>
<p><a href="https://github.com/Magnify-Cash/magnify-monorepo/blob/83f7c34f9b7f31d25f317e1b417033ab222d09b0/contracts/contracts/interfaces/IMagnifyCashV1.sol">Git Source</a></p>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<h3 id="initializenewlendingdesk"><a class="header" href="#initializenewlendingdesk">initializeNewLendingDesk</a></h3>
<p>Creates a new lending desk</p>
<p><em>Emits an {NewLendingDeskInitialized} event.</em></p>
<pre><code class="language-solidity">function initializeNewLendingDesk(address _erc20, uint256 _depositAmount, LoanConfig[] calldata _loanConfigs)
    external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_erc20</code></td><td><code>address</code></td><td>The ERC20 that will be accepted for loans in this lending desk</td></tr>
<tr><td><code>_depositAmount</code></td><td><code>uint256</code></td><td>The initial balance of this lending desk</td></tr>
<tr><td><code>_loanConfigs</code></td><td><code>LoanConfig[]</code></td><td>Loan config for each NFT collection this lending desk will support</td></tr>
</tbody></table>
</div>
<h3 id="setlendingdeskloanconfigs"><a class="header" href="#setlendingdeskloanconfigs">setLendingDeskLoanConfigs</a></h3>
<p>Creates a new lending configuration</p>
<p><em>Emits an {LendingDeskLoanConfigsSet} event.</em></p>
<pre><code class="language-solidity">function setLendingDeskLoanConfigs(uint256 _lendingDeskId, LoanConfig[] calldata _loanConfigs) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_lendingDeskId</code></td><td><code>uint256</code></td><td>Identifier for the lending desk</td></tr>
<tr><td><code>_loanConfigs</code></td><td><code>LoanConfig[]</code></td><td>Loan config for each NFT collection this lending desk will support</td></tr>
</tbody></table>
</div>
<h3 id="removelendingdeskloanconfig"><a class="header" href="#removelendingdeskloanconfig">removeLendingDeskLoanConfig</a></h3>
<p>Removes a new lending configuration</p>
<p><em>Emits an {LendingDeskLoanConfigsSet} event.</em></p>
<pre><code class="language-solidity">function removeLendingDeskLoanConfig(uint256 _lendingDeskId, address _nftCollection) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_lendingDeskId</code></td><td><code>uint256</code></td><td>Identifier for the lending desk</td></tr>
<tr><td><code>_nftCollection</code></td><td><code>address</code></td><td>Address for the NFT collection to remove supported config for</td></tr>
</tbody></table>
</div>
<h3 id="depositlendingdeskliquidity"><a class="header" href="#depositlendingdeskliquidity">depositLendingDeskLiquidity</a></h3>
<p>This function is called to add liquidity to a lending desk</p>
<p><em>Emits an {LendingDeskLiquidityDeposited} event.</em></p>
<pre><code class="language-solidity">function depositLendingDeskLiquidity(uint256 _lendingDeskId, uint256 _amount) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_lendingDeskId</code></td><td><code>uint256</code></td><td>The id of the lending desk</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>The balance to be transferred</td></tr>
</tbody></table>
</div>
<h3 id="withdrawlendingdeskliquidity"><a class="header" href="#withdrawlendingdeskliquidity">withdrawLendingDeskLiquidity</a></h3>
<p>This function is called to cash out a lending desk</p>
<p><em>Emits an {LendingDeskLiquidityWithdrawn} event.</em></p>
<pre><code class="language-solidity">function withdrawLendingDeskLiquidity(uint256 _lendingDeskId, uint256 _amount) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_lendingDeskId</code></td><td><code>uint256</code></td><td>The id of the lending desk to be cashout</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>Amount to withdraw from the lending desk</td></tr>
</tbody></table>
</div>
<h3 id="setlendingdeskstate"><a class="header" href="#setlendingdeskstate">setLendingDeskState</a></h3>
<p>This function can be called by the lending desk owner in order to freeze it</p>
<p><em>Emits an {LendingDeskStateSet} event.</em></p>
<pre><code class="language-solidity">function setLendingDeskState(uint256 _lendingDeskId, bool _freezed) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_lendingDeskId</code></td><td><code>uint256</code></td><td>ID of the lending desk to be frozen</td></tr>
<tr><td><code>_freezed</code></td><td><code>bool</code></td><td>Whether to freeze or unfreeze</td></tr>
</tbody></table>
</div>
<h3 id="initializenewloan"><a class="header" href="#initializenewloan">initializeNewLoan</a></h3>
<p>This function can be called by a borrower to create a loan</p>
<p><em>Emits an {NewLoanInitialized} event</em></p>
<pre><code class="language-solidity">function initializeNewLoan(
    uint64 _lendingDeskId,
    address _nftCollection,
    uint64 _nftId,
    uint32 _duration,
    uint256 _amount,
    uint32 _maxInterestAllowed
) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_lendingDeskId</code></td><td><code>uint64</code></td><td>ID of the lending desk related to this offer</td></tr>
<tr><td><code>_nftCollection</code></td><td><code>address</code></td><td>The NFT collection address to be used as collateral</td></tr>
<tr><td><code>_nftId</code></td><td><code>uint64</code></td><td>ID of the NFT to be used as collateral</td></tr>
<tr><td><code>_duration</code></td><td><code>uint32</code></td><td>Loan duration in hours</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>Amount to ask on this loan in ERC20</td></tr>
<tr><td><code>_maxInterestAllowed</code></td><td><code>uint32</code></td><td></td></tr>
</tbody></table>
</div>
<h3 id="getloanamountdue"><a class="header" href="#getloanamountdue">getLoanAmountDue</a></h3>
<p>This function can be called by anyone to get the remaining due amount of a loan</p>
<pre><code class="language-solidity">function getLoanAmountDue(uint256 _loanId) external view returns (uint256 amount);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_loanId</code></td><td><code>uint256</code></td><td>ID of the loan</td></tr>
</tbody></table>
</div>
<h3 id="makeloanpayment"><a class="header" href="#makeloanpayment">makeLoanPayment</a></h3>
<p>This function can be called by the obligation note holder to pay a loan and get the collateral back</p>
<p><em>Emits an {LoanPaymentMade} event.</em></p>
<pre><code class="language-solidity">function makeLoanPayment(uint256 _loanId, uint256 _amount, bool _resolve) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_loanId</code></td><td><code>uint256</code></td><td>ID of the loan</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>The amount to be paid, in erc20 tokens</td></tr>
<tr><td><code>_resolve</code></td><td><code>bool</code></td><td>Whether to resolve the loan or not. If true, _amount is ignored.</td></tr>
</tbody></table>
</div>
<h3 id="liquidatedefaultedloan"><a class="header" href="#liquidatedefaultedloan">liquidateDefaultedLoan</a></h3>
<p>This function is called by the desk owner in order to liquidate a loan and claim the NFT collateral</p>
<p><em>Emits an {LiquidatedOverdueLoan} event.</em></p>
<pre><code class="language-solidity">function liquidateDefaultedLoan(uint256 _loanId) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_loanId</code></td><td><code>uint256</code></td><td>ID of the loan</td></tr>
</tbody></table>
</div>
<h3 id="setloanoriginationfee"><a class="header" href="#setloanoriginationfee">setLoanOriginationFee</a></h3>
<p>Allows the admin of the contract to modify loan origination fee.</p>
<p><em>Emits an {LoanOriginationFeeSet} event.</em></p>
<pre><code class="language-solidity">function setLoanOriginationFee(uint256 _loanOriginationFee) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_loanOriginationFee</code></td><td><code>uint256</code></td><td>Basis points fee the borrower will have to pay to the platform when borrowing loan</td></tr>
</tbody></table>
</div>
<h3 id="setplatformwallet"><a class="header" href="#setplatformwallet">setPlatformWallet</a></h3>
<p>Allows the admin of the contract to set the platform wallet where platform fees will be sent to</p>
<p><em>Emits an {PlatformWalletSet} event.</em></p>
<pre><code class="language-solidity">function setPlatformWallet(address _platformWallet) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_platformWallet</code></td><td><code>address</code></td><td>Wallet where platform fees will be sent to</td></tr>
</tbody></table>
</div>
<h3 id="setpaused"><a class="header" href="#setpaused">setPaused</a></h3>
<p>Allows the admin of the contract to pause the contract as an emergency response.</p>
<p><em>Emits either a {Paused} or {Unpaused} event.</em></p>
<pre><code class="language-solidity">function setPaused(bool _paused) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_paused</code></td><td><code>bool</code></td><td>Whether to pause or unpause</td></tr>
</tbody></table>
</div>
<h2 id="structs"><a class="header" href="#structs">Structs</a></h2>
<h3 id="loan"><a class="header" href="#loan">Loan</a></h3>
<p>Struct used to store loans</p>
<pre><code class="language-solidity">struct Loan {
    uint256 amount;
    uint256 amountPaidBack;
    address nftCollection;
    uint64 startTime;
    uint64 nftId;
    uint64 lendingDeskId;
    uint32 duration;
    uint32 interest;
    LoanStatus status;
    bool nftCollectionIsErc1155;
}
</code></pre>
<h3 id="loanconfig"><a class="header" href="#loanconfig">LoanConfig</a></h3>
<p>Struct used to store loan config set by the shop owner for an NFT collection</p>
<pre><code class="language-solidity">struct LoanConfig {
    address nftCollection;
    bool nftCollectionIsErc1155;
    uint256 minAmount;
    uint256 maxAmount;
    uint32 minInterest;
    uint32 maxInterest;
    uint32 minDuration;
    uint32 maxDuration;
}
</code></pre>
<h3 id="lendingdesk"><a class="header" href="#lendingdesk">LendingDesk</a></h3>
<p>Struct used to store lending desks on this contract</p>
<pre><code class="language-solidity">struct LendingDesk {
    address erc20;
    uint256 balance;
    LendingDeskStatus status;
}
</code></pre>
<h2 id="enums"><a class="header" href="#enums">Enums</a></h2>
<h3 id="lendingdeskstatus"><a class="header" href="#lendingdeskstatus">LendingDeskStatus</a></h3>
<p>LendingDeskStatus used to store lending desk status</p>
<p>Active Default status when a lending desk is created</p>
<p>Frozen Used when a lender pauses or 'freezes' their desk</p>
<pre><code class="language-solidity">enum LendingDeskStatus {
    Active,
    Frozen
}
</code></pre>
<h3 id="loanstatus"><a class="header" href="#loanstatus">LoanStatus</a></h3>
<p>LoanStatus used to store loan status</p>
<p>Active Default status when a loan is issued</p>
<p>Resolved Used when a loan is fully paid back by borrower</p>
<p>Defaulted Used when a loan is liquidated by lender</p>
<pre><code class="language-solidity">enum LoanStatus {
    Active,
    Resolved,
    Defaulted
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="imagnifyerc721v1"><a class="header" href="#imagnifyerc721v1">IMagnifyERC721V1</a></h1>
<p><a href="https://github.com/Magnify-Cash/magnify-monorepo/blob/83f7c34f9b7f31d25f317e1b417033ab222d09b0/contracts/contracts/interfaces/IMagnifyERC721V1.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
IERC721</p>
<h2 id="functions-1"><a class="header" href="#functions-1">Functions</a></h2>
<h3 id="mint"><a class="header" href="#mint">mint</a></h3>
<pre><code class="language-solidity">function mint(address to, uint256 tokenId) external;
</code></pre>
<h3 id="burn"><a class="header" href="#burn">burn</a></h3>
<pre><code class="language-solidity">function burn(uint256 tokenId) external;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="contracts"><a class="header" href="#contracts">Contracts</a></h2>
<p>The MagnifyCash protocol consists of a single core contract and several peripheral contracts. Below is the contract structure:</p>
<ul>
<li><a href="contracts/contracts/contracts/contracts/MagnifyCashV1.sol/contract.MagnifyCashV1.html"><code>MagnifyCashV1.sol</code></a>: Core protocol module.</li>
<li><a href="contracts/contracts/contracts/contracts/MagnifyERC721V1.sol/contract.MagnifyERC721V1.html"><code>MagnifyERC721.sol</code></a>: Abstract ERC721 with built-in roles.</li>
<li><a href="contracts/contracts/contracts/contracts/MagnifyLendingKeysV1.sol/contract.MagnifyLendingKeysV1.html"><code>MagnifyLendingKeysV1.sol</code></a>: Lending desk NFT, tokenizing lending desk ownership.</li>
<li><a href="contracts/contracts/contracts/contracts/MagnifyObligationNotesV1.sol/contract.MagnifyObligationNotesV1.html"><code>MagnifyObligationNotesV1.sol</code></a>: Obligation note NFT, tokenizing a borrower's obligation to repay the loan.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="magnifycashv1"><a class="header" href="#magnifycashv1">MagnifyCashV1</a></h1>
<p><a href="https://github.com/Magnify-Cash/magnify-monorepo/blob/83f7c34f9b7f31d25f317e1b417033ab222d09b0/contracts/contracts/MagnifyCashV1.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/contracts/MagnifyCashV1.sol//contracts/contracts/interfaces/IMagnifyCashV1.sol/contract.IMagnifyCashV1.html">IMagnifyCashV1</a>, Ownable, Pausable, ERC721Holder, ERC1155Holder</p>
<h2 id="state-variables"><a class="header" href="#state-variables">State Variables</a></h2>
<h3 id="lendingdeskidcounter"><a class="header" href="#lendingdeskidcounter">lendingDeskIdCounter</a></h3>
<p>Unique identifier for lending desks</p>
<pre><code class="language-solidity">uint256 public lendingDeskIdCounter;
</code></pre>
<h3 id="loanidcounter"><a class="header" href="#loanidcounter">loanIdCounter</a></h3>
<p>Unique identifier for loans</p>
<pre><code class="language-solidity">uint256 public loanIdCounter;
</code></pre>
<h3 id="lendingdesks"><a class="header" href="#lendingdesks">lendingDesks</a></h3>
<p>Mapping to store lending desks</p>
<pre><code class="language-solidity">mapping(uint256 =&gt; LendingDesk) public lendingDesks;
</code></pre>
<h3 id="lendingdeskloanconfigs"><a class="header" href="#lendingdeskloanconfigs">lendingDeskLoanConfigs</a></h3>
<p>Mapping to store loan configs of lending desks</p>
<pre><code class="language-solidity">mapping(uint256 =&gt; mapping(address =&gt; LoanConfig)) public lendingDeskLoanConfigs;
</code></pre>
<h3 id="loans"><a class="header" href="#loans">loans</a></h3>
<p>Mapping to store loans</p>
<pre><code class="language-solidity">mapping(uint256 =&gt; Loan) public loans;
</code></pre>
<h3 id="obligationnotes"><a class="header" href="#obligationnotes">obligationNotes</a></h3>
<p>The address of the ERC721 to generate obligation notes for borrowers</p>
<pre><code class="language-solidity">address public immutable obligationNotes;
</code></pre>
<h3 id="lendingkeys"><a class="header" href="#lendingkeys">lendingKeys</a></h3>
<p>The address of the lending desk ownership ERC721</p>
<pre><code class="language-solidity">address public immutable lendingKeys;
</code></pre>
<h3 id="loanoriginationfee"><a class="header" href="#loanoriginationfee">loanOriginationFee</a></h3>
<p>The basis points of fees that the borrower will pay for each loan</p>
<pre><code class="language-solidity">uint256 public loanOriginationFee;
</code></pre>
<h3 id="platformwallet"><a class="header" href="#platformwallet">platformWallet</a></h3>
<p>The address of the platform wallet</p>
<pre><code class="language-solidity">address public platformWallet;
</code></pre>
<h2 id="functions-2"><a class="header" href="#functions-2">Functions</a></h2>
<h3 id="constructor"><a class="header" href="#constructor">constructor</a></h3>
<pre><code class="language-solidity">constructor(
    address _obligationNotes,
    address _lendingKeys,
    uint256 _loanOriginationFee,
    address _platformWallet,
    address _initialOwner
);
</code></pre>
<h3 id="initializenewlendingdesk-1"><a class="header" href="#initializenewlendingdesk-1">initializeNewLendingDesk</a></h3>
<p>Creates a new lending desk</p>
<p><em>Emits an {NewLendingDeskInitialized} event.</em></p>
<pre><code class="language-solidity">function initializeNewLendingDesk(address _erc20, uint256 _depositAmount, LoanConfig[] calldata _loanConfigs)
    external
    whenNotPaused;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_erc20</code></td><td><code>address</code></td><td>The ERC20 that will be accepted for loans in this lending desk</td></tr>
<tr><td><code>_depositAmount</code></td><td><code>uint256</code></td><td>The initial balance of this lending desk</td></tr>
<tr><td><code>_loanConfigs</code></td><td><code>LoanConfig[]</code></td><td>Loan config for each NFT collection this lending desk will support</td></tr>
</tbody></table>
</div>
<h3 id="setlendingdeskloanconfigs-1"><a class="header" href="#setlendingdeskloanconfigs-1">setLendingDeskLoanConfigs</a></h3>
<p>Creates a new lending configuration</p>
<p><em>Emits an {LendingDeskLoanConfigsSet} event.</em></p>
<pre><code class="language-solidity">function setLendingDeskLoanConfigs(uint256 _lendingDeskId, LoanConfig[] calldata _loanConfigs) public whenNotPaused;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_lendingDeskId</code></td><td><code>uint256</code></td><td>Identifier for the lending desk</td></tr>
<tr><td><code>_loanConfigs</code></td><td><code>LoanConfig[]</code></td><td>Loan config for each NFT collection this lending desk will support</td></tr>
</tbody></table>
</div>
<h3 id="_setlendingdeskloanconfigs"><a class="header" href="#_setlendingdeskloanconfigs">_setLendingDeskLoanConfigs</a></h3>
<pre><code class="language-solidity">function _setLendingDeskLoanConfigs(uint256 _lendingDeskId, LoanConfig[] calldata _loanConfigs) internal;
</code></pre>
<h3 id="removelendingdeskloanconfig-1"><a class="header" href="#removelendingdeskloanconfig-1">removeLendingDeskLoanConfig</a></h3>
<p>Removes a new lending configuration</p>
<p><em>Emits an {LendingDeskLoanConfigsSet} event.</em></p>
<pre><code class="language-solidity">function removeLendingDeskLoanConfig(uint256 _lendingDeskId, address _nftCollection) external whenNotPaused;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_lendingDeskId</code></td><td><code>uint256</code></td><td>Identifier for the lending desk</td></tr>
<tr><td><code>_nftCollection</code></td><td><code>address</code></td><td>Address for the NFT collection to remove supported config for</td></tr>
</tbody></table>
</div>
<h3 id="depositlendingdeskliquidity-1"><a class="header" href="#depositlendingdeskliquidity-1">depositLendingDeskLiquidity</a></h3>
<p>This function is called to add liquidity to a lending desk</p>
<p><em>Emits an {LendingDeskLiquidityDeposited} event.</em></p>
<pre><code class="language-solidity">function depositLendingDeskLiquidity(uint256 _lendingDeskId, uint256 _amount) public whenNotPaused;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_lendingDeskId</code></td><td><code>uint256</code></td><td>The id of the lending desk</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>The balance to be transferred</td></tr>
</tbody></table>
</div>
<h3 id="_depositlendingdeskliquidity"><a class="header" href="#_depositlendingdeskliquidity">_depositLendingDeskLiquidity</a></h3>
<pre><code class="language-solidity">function _depositLendingDeskLiquidity(uint256 _lendingDeskId, uint256 _amount) internal;
</code></pre>
<h3 id="withdrawlendingdeskliquidity-1"><a class="header" href="#withdrawlendingdeskliquidity-1">withdrawLendingDeskLiquidity</a></h3>
<p>This function is called to cash out a lending desk</p>
<p><em>Emits an {LendingDeskLiquidityWithdrawn} event.</em></p>
<pre><code class="language-solidity">function withdrawLendingDeskLiquidity(uint256 _lendingDeskId, uint256 _amount) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_lendingDeskId</code></td><td><code>uint256</code></td><td>The id of the lending desk to be cashout</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>Amount to withdraw from the lending desk</td></tr>
</tbody></table>
</div>
<h3 id="setlendingdeskstate-1"><a class="header" href="#setlendingdeskstate-1">setLendingDeskState</a></h3>
<p>This function can be called by the lending desk owner in order to freeze it</p>
<p><em>Emits an {LendingDeskStateSet} event.</em></p>
<pre><code class="language-solidity">function setLendingDeskState(uint256 _lendingDeskId, bool _freeze) external whenNotPaused;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_lendingDeskId</code></td><td><code>uint256</code></td><td>ID of the lending desk to be frozen</td></tr>
<tr><td><code>_freeze</code></td><td><code>bool</code></td><td>Whether to freeze or unfreeze</td></tr>
</tbody></table>
</div>
<h3 id="initializenewloan-1"><a class="header" href="#initializenewloan-1">initializeNewLoan</a></h3>
<p>This function can be called by a borrower to create a loan</p>
<p><em>Emits an {NewLoanInitialized} event</em></p>
<pre><code class="language-solidity">function initializeNewLoan(
    uint64 _lendingDeskId,
    address _nftCollection,
    uint64 _nftId,
    uint32 _duration,
    uint256 _amount,
    uint32 _maxInterestAllowed
) external whenNotPaused;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_lendingDeskId</code></td><td><code>uint64</code></td><td>ID of the lending desk related to this offer</td></tr>
<tr><td><code>_nftCollection</code></td><td><code>address</code></td><td>The NFT collection address to be used as collateral</td></tr>
<tr><td><code>_nftId</code></td><td><code>uint64</code></td><td>ID of the NFT to be used as collateral</td></tr>
<tr><td><code>_duration</code></td><td><code>uint32</code></td><td>Loan duration in hours</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>Amount to ask on this loan in ERC20</td></tr>
<tr><td><code>_maxInterestAllowed</code></td><td><code>uint32</code></td><td></td></tr>
</tbody></table>
</div>
<h3 id="getloanamountdue-1"><a class="header" href="#getloanamountdue-1">getLoanAmountDue</a></h3>
<p>This function can be called by anyone to get the remaining due amount of a loan</p>
<pre><code class="language-solidity">function getLoanAmountDue(uint256 _loanId) public view returns (uint256 amount);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_loanId</code></td><td><code>uint256</code></td><td>ID of the loan</td></tr>
</tbody></table>
</div>
<h3 id="makeloanpayment-1"><a class="header" href="#makeloanpayment-1">makeLoanPayment</a></h3>
<p>This function can be called by the obligation note holder to pay a loan and get the collateral back</p>
<p><em>Emits an {LoanPaymentMade} event.</em></p>
<pre><code class="language-solidity">function makeLoanPayment(uint256 _loanId, uint256 _amount, bool _resolve) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_loanId</code></td><td><code>uint256</code></td><td>ID of the loan</td></tr>
<tr><td><code>_amount</code></td><td><code>uint256</code></td><td>The amount to be paid, in erc20 tokens</td></tr>
<tr><td><code>_resolve</code></td><td><code>bool</code></td><td>Whether to resolve the loan or not. If true, _amount is ignored.</td></tr>
</tbody></table>
</div>
<h3 id="liquidatedefaultedloan-1"><a class="header" href="#liquidatedefaultedloan-1">liquidateDefaultedLoan</a></h3>
<p>This function is called by the lending desk key owner in order to liquidate a loan and claim the NFT collateral</p>
<p><em>Emits an {LiquidatedOverdueLoan} event.</em></p>
<pre><code class="language-solidity">function liquidateDefaultedLoan(uint256 _loanId) external;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_loanId</code></td><td><code>uint256</code></td><td>ID of the loan</td></tr>
</tbody></table>
</div>
<h3 id="setloanoriginationfee-1"><a class="header" href="#setloanoriginationfee-1">setLoanOriginationFee</a></h3>
<p>Allows the admin of the contract to modify loan origination fee.</p>
<p><em>Emits an {LoanOriginationFeeSet} event.</em></p>
<pre><code class="language-solidity">function setLoanOriginationFee(uint256 _loanOriginationFee) public onlyOwner;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_loanOriginationFee</code></td><td><code>uint256</code></td><td>Basis points fee the borrower will have to pay to the platform when borrowing loan</td></tr>
</tbody></table>
</div>
<h3 id="setplatformwallet-1"><a class="header" href="#setplatformwallet-1">setPlatformWallet</a></h3>
<p>Allows the admin of the contract to set the platform wallet where platform fees will be sent to</p>
<p><em>Emits an {PlatformWalletSet} event.</em></p>
<pre><code class="language-solidity">function setPlatformWallet(address _platformWallet) public onlyOwner;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_platformWallet</code></td><td><code>address</code></td><td>Wallet where platform fees will be sent to</td></tr>
</tbody></table>
</div>
<h3 id="setpaused-1"><a class="header" href="#setpaused-1">setPaused</a></h3>
<p>Allows the admin of the contract to pause the contract as an emergency response.</p>
<p><em>Emits either a {Paused} or {Unpaused} event.</em></p>
<pre><code class="language-solidity">function setPaused(bool _paused) external onlyOwner;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_paused</code></td><td><code>bool</code></td><td>Whether to pause or unpause</td></tr>
</tbody></table>
</div>
<h2 id="events"><a class="header" href="#events">Events</a></h2>
<h3 id="newlendingdeskinitialized"><a class="header" href="#newlendingdeskinitialized">NewLendingDeskInitialized</a></h3>
<p>Event that will be emitted every time a lending desk is created</p>
<pre><code class="language-solidity">event NewLendingDeskInitialized(
    uint256 lendingDeskId, address owner, address erc20, uint256 initialBalance, LoanConfig[] loanConfigs
);
</code></pre>
<h3 id="lendingdeskloanconfigsset"><a class="header" href="#lendingdeskloanconfigsset">LendingDeskLoanConfigsSet</a></h3>
<p>Event that will be emitted every time a lending desk config is created</p>
<pre><code class="language-solidity">event LendingDeskLoanConfigsSet(uint256 lendingDeskId, LoanConfig[] loanConfigs);
</code></pre>
<h3 id="lendingdeskloanconfigremoved"><a class="header" href="#lendingdeskloanconfigremoved">LendingDeskLoanConfigRemoved</a></h3>
<p>Event that will be emitted every time a lending desk config is removed</p>
<pre><code class="language-solidity">event LendingDeskLoanConfigRemoved(uint256 lendingDeskId, address nftCollection);
</code></pre>
<h3 id="lendingdeskliquiditydeposited"><a class="header" href="#lendingdeskliquiditydeposited">LendingDeskLiquidityDeposited</a></h3>
<p>Event that will be emitted every time liquidity is added to a lending desk</p>
<pre><code class="language-solidity">event LendingDeskLiquidityDeposited(uint256 lendingDeskId, uint256 amountDeposited);
</code></pre>
<h3 id="lendingdeskliquiditywithdrawn"><a class="header" href="#lendingdeskliquiditywithdrawn">LendingDeskLiquidityWithdrawn</a></h3>
<p>Event that will be emitted every time there is a cash out on a lending desk</p>
<pre><code class="language-solidity">event LendingDeskLiquidityWithdrawn(uint256 lendingDeskId, uint256 amountWithdrawn);
</code></pre>
<h3 id="lendingdeskstateset"><a class="header" href="#lendingdeskstateset">LendingDeskStateSet</a></h3>
<p>Event that will be emitted every time a lending desk is frozen// unfrozen</p>
<pre><code class="language-solidity">event LendingDeskStateSet(uint256 lendingDeskId, bool freeze);
</code></pre>
<h3 id="newloaninitialized"><a class="header" href="#newloaninitialized">NewLoanInitialized</a></h3>
<p>Event that will be emitted every time a new offer is accepted</p>
<pre><code class="language-solidity">event NewLoanInitialized(
    uint256 lendingDeskId,
    uint256 loanId,
    address borrower,
    address nftCollection,
    uint256 nftId,
    uint256 amount,
    uint256 duration,
    uint256 interest,
    uint256 platformFee
);
</code></pre>
<h3 id="loanpaymentmade"><a class="header" href="#loanpaymentmade">LoanPaymentMade</a></h3>
<p>Event that will be emitted every time a borrower pays back a loan</p>
<pre><code class="language-solidity">event LoanPaymentMade(uint256 loanId, uint256 amountPaid, bool resolved);
</code></pre>
<h3 id="defaultedloanliquidated"><a class="header" href="#defaultedloanliquidated">DefaultedLoanLiquidated</a></h3>
<p>Event that will be emitted every time a loan is liquidated when the obligation note holder did not pay it back in time</p>
<pre><code class="language-solidity">event DefaultedLoanLiquidated(uint256 loanId);
</code></pre>
<h3 id="protocolinitialized"><a class="header" href="#protocolinitialized">ProtocolInitialized</a></h3>
<p>Event that will be when the contract is deployed</p>
<pre><code class="language-solidity">event ProtocolInitialized(address obligationNotes, address lendingKeys);
</code></pre>
<h3 id="loanoriginationfeeset"><a class="header" href="#loanoriginationfeeset">LoanOriginationFeeSet</a></h3>
<p>Event that will be emitted every time an admin updates loan origination fee</p>
<pre><code class="language-solidity">event LoanOriginationFeeSet(uint256 loanOriginationFee);
</code></pre>
<h3 id="platformwalletset"><a class="header" href="#platformwalletset">PlatformWalletSet</a></h3>
<p>Event that will be emitted every time an admin updates the platform wallet</p>
<pre><code class="language-solidity">event PlatformWalletSet(address platformWallet);
</code></pre>
<h2 id="errors"><a class="header" href="#errors">Errors</a></h2>
<h3 id="obligationnotesiszeroaddr"><a class="header" href="#obligationnotesiszeroaddr">ObligationNotesIsZeroAddr</a></h3>
<pre><code class="language-solidity">error ObligationNotesIsZeroAddr();
</code></pre>
<h3 id="lendingkeysiszeroaddr"><a class="header" href="#lendingkeysiszeroaddr">LendingKeysIsZeroAddr</a></h3>
<pre><code class="language-solidity">error LendingKeysIsZeroAddr();
</code></pre>
<h3 id="erc20iszeroaddr"><a class="header" href="#erc20iszeroaddr">ERC20IsZeroAddr</a></h3>
<pre><code class="language-solidity">error ERC20IsZeroAddr();
</code></pre>
<h3 id="invalidlendingdeskid"><a class="header" href="#invalidlendingdeskid">InvalidLendingDeskId</a></h3>
<pre><code class="language-solidity">error InvalidLendingDeskId();
</code></pre>
<h3 id="callerisnotlendingdeskowner"><a class="header" href="#callerisnotlendingdeskowner">CallerIsNotLendingDeskOwner</a></h3>
<pre><code class="language-solidity">error CallerIsNotLendingDeskOwner();
</code></pre>
<h3 id="minamountiszero"><a class="header" href="#minamountiszero">MinAmountIsZero</a></h3>
<pre><code class="language-solidity">error MinAmountIsZero();
</code></pre>
<h3 id="maxamountislessthanmin"><a class="header" href="#maxamountislessthanmin">MaxAmountIsLessThanMin</a></h3>
<pre><code class="language-solidity">error MaxAmountIsLessThanMin();
</code></pre>
<h3 id="mininterestiszero"><a class="header" href="#mininterestiszero">MinInterestIsZero</a></h3>
<pre><code class="language-solidity">error MinInterestIsZero();
</code></pre>
<h3 id="maxinterestislessthanmin"><a class="header" href="#maxinterestislessthanmin">MaxInterestIsLessThanMin</a></h3>
<pre><code class="language-solidity">error MaxInterestIsLessThanMin();
</code></pre>
<h3 id="mindurationiszero"><a class="header" href="#mindurationiszero">MinDurationIsZero</a></h3>
<pre><code class="language-solidity">error MinDurationIsZero();
</code></pre>
<h3 id="maxdurationislessthanmin"><a class="header" href="#maxdurationislessthanmin">MaxDurationIsLessThanMin</a></h3>
<pre><code class="language-solidity">error MaxDurationIsLessThanMin();
</code></pre>
<h3 id="invalidinterest"><a class="header" href="#invalidinterest">InvalidInterest</a></h3>
<pre><code class="language-solidity">error InvalidInterest();
</code></pre>
<h3 id="invalidnftcollection"><a class="header" href="#invalidnftcollection">InvalidNFTCollection</a></h3>
<pre><code class="language-solidity">error InvalidNFTCollection();
</code></pre>
<h3 id="lendingdeskisnotactive"><a class="header" href="#lendingdeskisnotactive">LendingDeskIsNotActive</a></h3>
<pre><code class="language-solidity">error LendingDeskIsNotActive();
</code></pre>
<h3 id="insufficientlendingdeskbalance"><a class="header" href="#insufficientlendingdeskbalance">InsufficientLendingDeskBalance</a></h3>
<pre><code class="language-solidity">error InsufficientLendingDeskBalance();
</code></pre>
<h3 id="unsupportednftcollection"><a class="header" href="#unsupportednftcollection">UnsupportedNFTCollection</a></h3>
<pre><code class="language-solidity">error UnsupportedNFTCollection();
</code></pre>
<h3 id="amountiszero"><a class="header" href="#amountiszero">AmountIsZero</a></h3>
<pre><code class="language-solidity">error AmountIsZero();
</code></pre>
<h3 id="lendingdeskisnotfrozen"><a class="header" href="#lendingdeskisnotfrozen">LendingDeskIsNotFrozen</a></h3>
<pre><code class="language-solidity">error LendingDeskIsNotFrozen();
</code></pre>
<h3 id="invalidloanid"><a class="header" href="#invalidloanid">InvalidLoanId</a></h3>
<pre><code class="language-solidity">error InvalidLoanId();
</code></pre>
<h3 id="lendingdeskisnotempty"><a class="header" href="#lendingdeskisnotempty">LendingDeskIsNotEmpty</a></h3>
<pre><code class="language-solidity">error LendingDeskIsNotEmpty();
</code></pre>
<h3 id="loanamounttoolow"><a class="header" href="#loanamounttoolow">LoanAmountTooLow</a></h3>
<pre><code class="language-solidity">error LoanAmountTooLow();
</code></pre>
<h3 id="loanamounttoohigh"><a class="header" href="#loanamounttoohigh">LoanAmountTooHigh</a></h3>
<pre><code class="language-solidity">error LoanAmountTooHigh();
</code></pre>
<h3 id="loandurationtoolow"><a class="header" href="#loandurationtoolow">LoanDurationTooLow</a></h3>
<pre><code class="language-solidity">error LoanDurationTooLow();
</code></pre>
<h3 id="loandurationtoohigh"><a class="header" href="#loandurationtoohigh">LoanDurationTooHigh</a></h3>
<pre><code class="language-solidity">error LoanDurationTooHigh();
</code></pre>
<h3 id="loanisnotactive"><a class="header" href="#loanisnotactive">LoanIsNotActive</a></h3>
<pre><code class="language-solidity">error LoanIsNotActive();
</code></pre>
<h3 id="callerisnotborrower"><a class="header" href="#callerisnotborrower">CallerIsNotBorrower</a></h3>
<pre><code class="language-solidity">error CallerIsNotBorrower();
</code></pre>
<h3 id="callerisnotlender"><a class="header" href="#callerisnotlender">CallerIsNotLender</a></h3>
<pre><code class="language-solidity">error CallerIsNotLender();
</code></pre>
<h3 id="loanhasnotdefaulted"><a class="header" href="#loanhasnotdefaulted">LoanHasNotDefaulted</a></h3>
<pre><code class="language-solidity">error LoanHasNotDefaulted();
</code></pre>
<h3 id="loanhasdefaulted"><a class="header" href="#loanhasdefaulted">LoanHasDefaulted</a></h3>
<pre><code class="language-solidity">error LoanHasDefaulted();
</code></pre>
<h3 id="platformwalletiszeroaddr"><a class="header" href="#platformwalletiszeroaddr">PlatformWalletIsZeroAddr</a></h3>
<pre><code class="language-solidity">error PlatformWalletIsZeroAddr();
</code></pre>
<h3 id="loanmustbeactiveformin1hour"><a class="header" href="#loanmustbeactiveformin1hour">LoanMustBeActiveForMin1Hour</a></h3>
<pre><code class="language-solidity">error LoanMustBeActiveForMin1Hour();
</code></pre>
<h3 id="loanpaymentexceedsdebt"><a class="header" href="#loanpaymentexceedsdebt">LoanPaymentExceedsDebt</a></h3>
<pre><code class="language-solidity">error LoanPaymentExceedsDebt();
</code></pre>
<h3 id="interestratetoohigh"><a class="header" href="#interestratetoohigh">InterestRateTooHigh</a></h3>
<pre><code class="language-solidity">error InterestRateTooHigh();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="magnifyerc721v1"><a class="header" href="#magnifyerc721v1">MagnifyERC721V1</a></h1>
<p><a href="https://github.com/Magnify-Cash/magnify-monorepo/blob/83f7c34f9b7f31d25f317e1b417033ab222d09b0/contracts/contracts/MagnifyERC721V1.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
ERC721, Ownable</p>
<h2 id="state-variables-1"><a class="header" href="#state-variables-1">State Variables</a></h2>
<h3 id="baseuri"><a class="header" href="#baseuri">baseURI</a></h3>
<pre><code class="language-solidity">string public baseURI;
</code></pre>
<h3 id="magnifycash-1"><a class="header" href="#magnifycash-1">magnifyCash</a></h3>
<pre><code class="language-solidity">address public magnifyCash;
</code></pre>
<h3 id="_name"><a class="header" href="#_name">_name</a></h3>
<pre><code class="language-solidity">string private _name;
</code></pre>
<h3 id="_symbol"><a class="header" href="#_symbol">_symbol</a></h3>
<pre><code class="language-solidity">string private _symbol;
</code></pre>
<h2 id="functions-3"><a class="header" href="#functions-3">Functions</a></h2>
<h3 id="onlymagnifycash"><a class="header" href="#onlymagnifycash">onlyMagnifyCash</a></h3>
<p><em>Requires caller to be the Magnify Cash contract</em></p>
<pre><code class="language-solidity">modifier onlyMagnifyCash();
</code></pre>
<h3 id="constructor-1"><a class="header" href="#constructor-1">constructor</a></h3>
<pre><code class="language-solidity">constructor(string memory name, string memory symbol, string memory _baseURI, address initialOwner);
</code></pre>
<h3 id="name"><a class="header" href="#name">name</a></h3>
<pre><code class="language-solidity">function name() public view override returns (string memory);
</code></pre>
<h3 id="symbol"><a class="header" href="#symbol">symbol</a></h3>
<pre><code class="language-solidity">function symbol() public view override returns (string memory);
</code></pre>
<h3 id="tokenuri"><a class="header" href="#tokenuri">tokenURI</a></h3>
<pre><code class="language-solidity">function tokenURI(uint256 tokenId) public view override returns (string memory);
</code></pre>
<h3 id="setmagnifycash"><a class="header" href="#setmagnifycash">setMagnifyCash</a></h3>
<p><em>Set Magnify Cash contract address, requires caller to be owner</em></p>
<pre><code class="language-solidity">function setMagnifyCash(address _magnifyCash) external onlyOwner;
</code></pre>
<h3 id="setbaseuri"><a class="header" href="#setbaseuri">setBaseURI</a></h3>
<p><em>Update base URI but requires caller to be owner</em></p>
<pre><code class="language-solidity">function setBaseURI(string memory _baseURI) external onlyOwner;
</code></pre>
<h3 id="mint-1"><a class="header" href="#mint-1">mint</a></h3>
<p><em>Call _mint but requires caller to be the Magnify Cash contract</em></p>
<pre><code class="language-solidity">function mint(address to, uint256 tokenId) external onlyMagnifyCash;
</code></pre>
<h3 id="burn-1"><a class="header" href="#burn-1">burn</a></h3>
<p><em>Call _burn but requires caller to be the Magnify Cash contract</em></p>
<pre><code class="language-solidity">function burn(uint256 tokenId) external onlyMagnifyCash;
</code></pre>
<h2 id="events-1"><a class="header" href="#events-1">Events</a></h2>
<h3 id="initialized"><a class="header" href="#initialized">Initialized</a></h3>
<pre><code class="language-solidity">event Initialized(address owner, string name, string symbol, string baseURI);
</code></pre>
<h3 id="baseuriset"><a class="header" href="#baseuriset">BaseURISet</a></h3>
<pre><code class="language-solidity">event BaseURISet(string indexed baseURI);
</code></pre>
<h3 id="magnifycashset"><a class="header" href="#magnifycashset">MagnifyCashSet</a></h3>
<pre><code class="language-solidity">event MagnifyCashSet(address indexed magnifyCash);
</code></pre>
<h2 id="errors-1"><a class="header" href="#errors-1">Errors</a></h2>
<h3 id="nameisempty"><a class="header" href="#nameisempty">NameIsEmpty</a></h3>
<pre><code class="language-solidity">error NameIsEmpty();
</code></pre>
<h3 id="symbolisempty"><a class="header" href="#symbolisempty">SymbolIsEmpty</a></h3>
<pre><code class="language-solidity">error SymbolIsEmpty();
</code></pre>
<h3 id="baseuriisempty"><a class="header" href="#baseuriisempty">BaseURIIsEmpty</a></h3>
<pre><code class="language-solidity">error BaseURIIsEmpty();
</code></pre>
<h3 id="callerisnotmagnifycash"><a class="header" href="#callerisnotmagnifycash">CallerIsNotMagnifyCash</a></h3>
<pre><code class="language-solidity">error CallerIsNotMagnifyCash();
</code></pre>
<h3 id="minttozeroaddress"><a class="header" href="#minttozeroaddress">MintToZeroAddress</a></h3>
<pre><code class="language-solidity">error MintToZeroAddress();
</code></pre>
<h3 id="magnifycashiszeroaddress"><a class="header" href="#magnifycashiszeroaddress">MagnifyCashIsZeroAddress</a></h3>
<pre><code class="language-solidity">error MagnifyCashIsZeroAddress();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="magnifylendingkeysv1"><a class="header" href="#magnifylendingkeysv1">MagnifyLendingKeysV1</a></h1>
<p><a href="https://github.com/Magnify-Cash/magnify-monorepo/blob/83f7c34f9b7f31d25f317e1b417033ab222d09b0/contracts/contracts/MagnifyLendingKeysV1.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/contracts/MagnifyLendingKeysV1.sol//contracts/contracts/MagnifyERC721V1.sol/contract.MagnifyERC721V1.html">MagnifyERC721V1</a></p>
<h2 id="functions-4"><a class="header" href="#functions-4">Functions</a></h2>
<h3 id="constructor-2"><a class="header" href="#constructor-2">constructor</a></h3>
<pre><code class="language-solidity">constructor(string memory _name, string memory _symbol, string memory _baseURI, address _initialOwner)
    MagnifyERC721V1(_name, _symbol, _baseURI, _initialOwner);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="magnifyobligationnotesv1"><a class="header" href="#magnifyobligationnotesv1">MagnifyObligationNotesV1</a></h1>
<p><a href="https://github.com/Magnify-Cash/magnify-monorepo/blob/83f7c34f9b7f31d25f317e1b417033ab222d09b0/contracts/contracts/MagnifyObligationNotesV1.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/contracts/MagnifyObligationNotesV1.sol//contracts/contracts/MagnifyERC721V1.sol/contract.MagnifyERC721V1.html">MagnifyERC721V1</a></p>
<h2 id="functions-5"><a class="header" href="#functions-5">Functions</a></h2>
<h3 id="constructor-3"><a class="header" href="#constructor-3">constructor</a></h3>
<pre><code class="language-solidity">constructor(string memory _name, string memory _symbol, string memory _baseURI, address _initialOwner)
    MagnifyERC721V1(_name, _symbol, _baseURI, _initialOwner);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents"><a class="header" href="#contents">Contents</a></h1>
<ul>
<li><a href="integration/basic-integration.html">Basic Integration (Ethers)</a></li>
<li>Basic Integration (WAGMI): Coming soon</li>
<li>Basic Integration (Web3Py): Coming soon</li>
<li>Advanced Integration (Ethers): Coming soon</li>
<li>Advanced Integration (WAGMI): Coming soon</li>
<li>Advanced Integration (Web3Py): Coming soon</li>
<li>GraphQL Integration: Coming soon</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="introduction"><a class="header" href="#introduction">Introduction</a></h2>
<p>The MagnifyCashV1 contract is a decentralized lending platform that allows users to lend and borrow against their NFT assets. This integration guide will walk you through the process of interacting with the MagnifyCashV1 contract using the Ethers.js library. You'll learn how to initialize new lending desks, set loan configurations, deposit and withdraw liquidity, and initiate new loans.</p>
<h2 id="integration-steps"><a class="header" href="#integration-steps">Integration Steps</a></h2>
<p>This guide covers the following key functionalities:</p>
<ul>
<li>Initializing a new lending desk</li>
<li>Setting new loan configs for a lending desk</li>
<li>Depositing liquidity into a lending desk</li>
<li>Withdrawing liquidity from a lending desk</li>
<li>Initializing a new loan</li>
</ul>
<p>You'll need to replace the following placeholders with your actual values:</p>
<ul>
<li><code>your-ethereum-node-url</code>: The URL of your Ethereum node (e.g., Infura, Alchemy, or your own node)</li>
<li><code>your-private-key</code>: The private key of the Ethereum account you'll be using to interact with the contract</li>
<li><code>contract-address</code>: The address of the deployed MagnifyCashV1 contract</li>
<li><code>0x...</code>: The addresses of the ERC20 token, NFT collection, and other contract-specific addresses</li>
</ul>
<h2 id="code"><a class="header" href="#code">Code</a></h2>
<pre><code class="language-javascript">// Import the necessary Ethers.js modules
const { ethers } = require('ethers');

// Set up the provider and signer
const provider = new ethers.providers.JsonRpcProvider('https://your-ethereum-node-url');
const signer = new ethers.Wallet('your-private-key', provider);

// Load the contract ABI
const contractABI = [
  // Contract ABI goes here
];

// Create the contract instance
const contract = new ethers.Contract('contract-address', contractABI, signer);

// Example usage: Initialize a new lending desk
const erc20 = '0x...'; // Address of the ERC20 token to be used
const depositAmount = ethers.utils.parseEther('1000'); // Initial balance of the lending desk
const loanConfigs = [
  {
    nftCollection: '0x...', // Address of the NFT collection
    minAmount: ethers.utils.parseEther('0.1'), // Minimum loan amount
    maxAmount: ethers.utils.parseEther('1'), // Maximum loan amount
    minInterest: 500, // Minimum interest rate (in basis points)
    maxInterest: 2000, // Maximum interest rate (in basis points)
    minDuration: 24, // Minimum loan duration (in hours)
    maxDuration: 720 // Maximum loan duration (in hours)
  }
];

async function initializeNewLendingDesk() {
  try {
    const tx = await contract.initializeNewLendingDesk(erc20, depositAmount, loanConfigs);
    await tx.wait(); // Wait for the transaction to be mined
    console.log('New lending desk initialized');
  } catch (error) {
    console.error('Error initializing new lending desk:', error);
  }
}

// Example usage: Set new loan configs for a lending desk
const lendingDeskId = 1;
const newLoanConfigs = [
  // New loan config details
];

async function setLendingDeskLoanConfigs() {
  try {
    const tx = await contract.setLendingDeskLoanConfigs(lendingDeskId, newLoanConfigs);
    await tx.wait(); // Wait for the transaction to be mined
    console.log('Lending desk loan configs updated');
  } catch (error) {
    console.error('Error updating lending desk loan configs:', error);
  }
}

// Example usage: Deposit liquidity into a lending desk
const lendingDeskId = 1;
const depositAmount = ethers.utils.parseEther('100');

async function depositLendingDeskLiquidity() {
  try {
    const tx = await contract.depositLendingDeskLiquidity(lendingDeskId, depositAmount);
    await tx.wait(); // Wait for the transaction to be mined
    console.log('Liquidity deposited into lending desk');
  } catch (error) {
    console.error('Error depositing liquidity into lending desk:', error);
  }
}

// Example usage: Withdraw liquidity from a lending desk
const lendingDeskId = 1;
const withdrawalAmount = ethers.utils.parseEther('50');

async function withdrawLendingDeskLiquidity() {
  try {
    const tx = await contract.withdrawLendingDeskLiquidity(lendingDeskId, withdrawalAmount);
    await tx.wait(); // Wait for the transaction to be mined
    console.log('Liquidity withdrawn from lending desk');
  } catch (error) {
    console.error('Error withdrawing liquidity from lending desk:', error);
  }
}

// Example usage: Initialize a new loan
const lendingDeskId = 1;
const nftCollection = '0x...'; // Address of the NFT collection
const nftId = 123; // ID of the NFT to be used as collateral
const loanAmount = ethers.utils.parseEther('0.5');
const loanDuration = 72; // Duration in hours
const maxInterestAllowed = 1500; // Maximum interest rate (in basis points)

async function initializeNewLoan() {
  try {
    const tx = await contract.initializeNewLoan(
      lendingDeskId,
      nftCollection,
      nftId,
      loanDuration,
      loanAmount,
      maxInterestAllowed
    );
    await tx.wait(); // Wait for the transaction to be mined
    console.log('New loan initialized');
  } catch (error) {
    console.error('Error initializing new loan:', error);
  }
}
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="solidity.min.js"></script>

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
