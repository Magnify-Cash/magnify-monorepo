query Home {
  protocolInfo(id: "0") {
    id
    lendingDesksCount
    lendingKeys
    loanOriginationFee
    loansCount
    obligationNotes
    owner
    paused
    platformWallet
    erc20sCount
    nftCollectionsCount
  }
}

query ManageLendingDesks($walletAddress: String!, $status:LendingDeskStatus!, $after:String) {
  lendingDesks(where: { ownerId: $walletAddress, status:$status }, after:$after) {
    items {
      id
      balance
      status
      loansCount
      loansDefaultedCount
      loansResolvedCount
      amountBorrowed
      netLiquidityIssued
      netProfit
      erc20 {
        id
        symbol
        decimals
      }
      loanConfigs {
        items {
          id
        }
      }
      loans {
        items {
          status
        }
      }
    }
    pageInfo {
        endCursor
        hasNextPage
    }
  }
}

query CreateLendingDesk($walletAddress: String!) {
  lendingDesks(where: { ownerId: $walletAddress }) {
    items {
      id
      balance
      status
    }
  }
}

query ManageLendingDesk($deskId: String!) {
  lendingDesk(id: $deskId) {
    id
    owner {
      id
    }
    erc20 {
      id
      symbol
      decimals
    }
    balance
    status
    loanConfigs(where: { active: true }) {
      items {
        nftCollection {
          id
        }
        id
        minAmount
        maxAmount
        minInterest
        maxInterest
        minDuration
        maxDuration
      }
    }
    loans {
      items {
        status
      }
    }
  }
}

query BrowseCollections($after: String) {
  nftCollections(where: { activeLoanConfigsCount_gt: "0" }, after:$after) {
    items {
      id
      loanConfigs {
        items {
          lendingDesk {
            erc20 {
              id
              symbol
              decimals
            }
          }
        }
      }
    }
    pageInfo {
        endCursor
        hasNextPage
    }
  }
  protocolInfo(id: "0") {
    erc20sCount
    nftCollectionsCount
  }
}

query BrowseCollection($nftCollectionId: String, $after: String) {
  lendingDesks(
    where: { status: Active, balance_gt: "0" }
    orderBy: "balance"
    orderDirection: "desc"
    after: $after
  ) {
    items {
      id
      balance
      status
      owner {
        id
      }
      erc20 {
        id
        symbol
        decimals
      }
      loanConfigs(where: { nftCollectionId: $nftCollectionId }) {
        items {
          nftCollection {
            id
          }
          minAmount
          maxAmount
          minInterest
          maxInterest
          minDuration
          maxDuration
        }
      }
    }
    pageInfo {
        endCursor
        hasNextPage
    }
  }
}

query QuickLoan($erc20Id: String!, $nftCollectionId: String!, $after:String) {
  lendingDesks(
    where: { erc20Id: $erc20Id, status: Active, balance_gt: "0" }
    orderBy: "balance"
    orderDirection: "desc"
    after: $after
  ) {
    items {
      id
      balance
      status
      erc20 {
        id
        symbol
        decimals
      }
      loanConfigs(where: { nftCollectionId: $nftCollectionId }) {
        items {
          minAmount
          maxAmount
          minDuration
          maxDuration
          minInterest
          maxInterest
          nftCollection {
            id
          }
        }
      }
    }
    pageInfo {
        endCursor
        hasNextPage
    }
  }
  nftCollections(where: { activeLoanConfigsCount_gt: "0" }) {
    items {
      id
    }
  }
}

query GetErc20sForNftCollection($nftCollectionId: String!) {
  nftCollection(id: $nftCollectionId) {
    erc20s {
      items {
        erc20 {
          id
        }
      }
    }
  }
}

query BorrowerDashboard($walletAddress: String!, $after: String) {
  loans(where: { borrowerId: $walletAddress }, after: $after) {
    items {
      id
      amount
      amountPaidBack
      duration
      startTime
      nftCollection {
        id
      }
      lendingDesk {
        erc20 {
          id
          symbol
          decimals
        }
      }
      nftId
      interest
      status
      lender {
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}

query LenderDashboard($walletAddress: String!) {
  loans(where: { lenderId: $walletAddress }) {
    items {
      id
      amount
      amountPaidBack
      duration
      startTime
      nftCollection {
        id
      }
      lendingDesk {
        id
        erc20 {
          id
          symbol
          decimals
        }
      }
      nftId
      interest
      status
      lender {
        id
      }
    }
  }
}
